{"componentChunkName":"component---src-templates-blog-post-js","path":"/javascript/web-bluetooth-통신/","result":{"data":{"site":{"siteMetadata":{"title":"📕 정리노트","author":"김대완","siteUrl":"https://dawan0111.github.io","comment":{"disqusShortName":"","utterances":"dawan0111/dawan0111.github.io"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"07b2c86f-7c6d-58cc-9f9e-05747f40c8cd","excerpt":"Web Bluetooth API? 브라우저에서 Bluetooth 통신으로 주변장치와 상호작용을 할 수 있습니다. 이는 실험적 기술이며 일부 브라우저에서 지원하고 HTTPS 환경에서만 작동됩니다. (Chrome, Edge) 만약 블루투스 통신이 필요한데 안드로이드나 IOS의 지식이 부족하다면 Web을 통하여 통신하는것은 어떨까요?\n Bluetooth 모듈 웹과 통신할 블루투스 모듈이 필요합니다. 저는 이미 블루투스 모듈 HM-06을 가지고 있었지만 HM-1…","html":"<h2 id=\"web-bluetooth-api\" style=\"position:relative;\"><a href=\"#web-bluetooth-api\" aria-label=\"web bluetooth api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Bluetooth API?</h2>\n<p>브라우저에서 Bluetooth 통신으로 주변장치와 상호작용을 할 수 있습니다. 이는 실험적 기술이며 일부 브라우저에서 지원하고 HTTPS 환경에서만 작동됩니다. (Chrome, Edge) 만약 블루투스 통신이 필요한데 안드로이드나 IOS의 지식이 부족하다면 Web을 통하여 통신하는것은 어떨까요?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACE0lEQVQoz21Sa3PTMBD0//8ftEPTPNqBljJ9ZPoKhCaBlDq2bDmybEuO7ZiEoZ+XO3VaOsCHHe1Jp71d2V7btliv1+B1tVrBWoumadxelmUOzHmPz4uicJyR57kDn9d17eD9LZim6UsjcxZ8rhlxHDvR1z3P3BjzryCDp/M0XpVSL3sMIcSLIK8sWJal6/mvQ57y+oLW+g8nt+yQRZbLpXOvlsr1cM09TvAZVVXB932EIkQURRBhCCml44yQ6iAIaA0c5zMeEJFr33+Av/DhsXqSJNA01ViDefQF37NviGY3MO/eozw6QrwYI7ofwVKtBwdQYgIV3MEeH0OWPrLbIbKrc8TVAl6aGyRpDqX5gRVm4hbTdAwxPkXb6WCz34WYXyKcXhDfR/lmByaZoBBjtL0u1I8FVpcfUQ1PoB8jeJLEEl2QqEEQSSz0FEF9j3R+jU2vj5+DAVT4GcofYdsfoN7rwC6nMPEdtoeHJBigvjlDc3kK/SuGFwhJj02f3ZRQFHsWjfA1uyOHZ6jockOuxP0VwtkQTWcfxc4OMnoWHXxCTQ5l/QBD7uz5BySb4ClyrHJIRV9QxhR5hJmLfObE2m4X4ZwEp0O0FN/s7iIndxm5Xvd7SBofliKXFydYbgW83K6gixJZYek30JgnY8yLCSQJuMgUUz7cIibRbb+P6u0erJrBxhNsDg6QbkLU10+Rs0eJ3zotED/iXb7uAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"블루투스 브라우저 지원 표\"\n        title=\"블루투스 브라우저 지원 표\"\n        src=\"/static/858707d4374b663348b973f0f435dc90/fcda8/bluetooth.png\"\n        srcset=\"/static/858707d4374b663348b973f0f435dc90/12f09/bluetooth.png 148w,\n/static/858707d4374b663348b973f0f435dc90/e4a3f/bluetooth.png 295w,\n/static/858707d4374b663348b973f0f435dc90/fcda8/bluetooth.png 590w,\n/static/858707d4374b663348b973f0f435dc90/efc66/bluetooth.png 885w,\n/static/858707d4374b663348b973f0f435dc90/c83ae/bluetooth.png 1180w,\n/static/858707d4374b663348b973f0f435dc90/813c1/bluetooth.png 2004w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h2 id=\"bluetooth-모듈\" style=\"position:relative;\"><a href=\"#bluetooth-%EB%AA%A8%EB%93%88\" aria-label=\"bluetooth 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bluetooth 모듈</h2>\n<p>웹과 통신할 블루투스 모듈이 필요합니다. 저는 이미 블루투스 모듈 HM-06을 가지고 있었지만 HM-10 구매해서 사용했습니다. 왜냐하면 웹과 블루투스 통신을 하려면 bluetooth 4.0 버전 이상이 필요합니다. 그러나 HM-06 모듈은 bluetooth 4.0을 지원하지 않기 때문입니다.</p>\n<p><a href=\"https://componxents101.com/wireless/hm-10-bluetooth-module\">HM-10 스펙</a></p>\n<h2 id=\"arduino\" style=\"position:relative;\"><a href=\"#arduino\" aria-label=\"arduino permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Arduino</h2>\n<p>배선은 간단합니다. VCC, GND는 기본적으로 연결하고, RX, TX핀에 교차하여 연결하거나 SoftwareSerial.h 헤더파일을 사용해 통신에 사용될 핀을 설정합니다. 자세한 설명은 밑에 링크에서 확인할 수 있습니다.</p>\n<p><a href=\"https://m.blog.naver.com/eduino/220903237343\">HM-10 배선 및 소스코드</a></p>\n<p>그 후 시리얼을 킨 후 AT 명령어를 활용하여 블루투스 모듈을 설정 및 값을 가져옵니다.</p>\n<ol>\n<li>AT+ROLE0</li>\n<li>AT+NAME 사용할 이름</li>\n<li>AT+RESET</li>\n<li>AT+UUID</li>\n<li>AT+CHAR</li>\n</ol>\n<p>4번과 5번에서 나온 결과를 꼭 기억 해두세요.</p>\n<h2 id=\"web\" style=\"position:relative;\"><a href=\"#web\" aria-label=\"web permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web</h2>\n<p>이제 웹에서 데이터를 보내거나 받을 차례 입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bluetoothButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>블루투스!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword\">const</span> bluetoothButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bluetoothButton\"</span><span class=\"token punctuation\">)</span>\n\nbluetoothButton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  navigator<span class=\"token punctuation\">.</span>bluetooth<span class=\"token punctuation\">.</span><span class=\"token function\">requestDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    filters<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> services<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"4번 결과 값\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>웹페이지 접속과 동시에 bluetooth 연결요청을 할 수 없습니다. 버튼 한개를 만들어 클릭시 장치를 찾게 만들어 줍니다. filters에 services에 아무 값도 입력하지 않으면 연결 할 수 있는 모든 장치가 나타나므로 우리가 원하는 모듈을 쉽게 찾기 위해 4번에서 나온 UUID를 services 안에 넣어 줍니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3UlEQVQ4y61UiZKCMAzl/z/R1VW5QS5Bbko2LxBHV509mcmkCW363msbq21bulwuVJYllVXFvpL4zHEFfz7LvzzPqSgKGVc8bxgGGsfxwSxM2O3eabvdked5YkfbFvN9n/aHg/jN5o32+/11zjzPhA8eQ40t7ISgaVpBo0hOp4TSNGW09TWHOM8LyrJcmOAzZpb18MYYsvq+J9BeipwYTUBxHJPruozEp4SL+EFAARuQBes4SRIap0moD0wVfuLY6rqOci4WcRGPqdmOIx5UD0ebwihif5S843oydngz5C91LTqrR1ELQkJk0IIBXZplgiLiRZBBcowUDDCGT9PsRkOlbRYNMTnmSdAN9ITyKr5SdhkdcpAEY6zB2o4lg2zwcsoIUCwIQzHQQQGcMmhCCuRUCpUFB1M3jdBVu1IGLYgMAwJQchxXEGYrfYxD3hBz4JFXyuqvlPWSIoGTgiGG15zGasg/LQjKv/30MD4VHB5O67v2AuHwsNtPUf4bwi8p/+W7O5S/oHv6UpYtjJgCxc9XNpllrsYLwmWNNIc4jqhsDJWtoZofecEX/ZUE80ovOnOnmdD2aumlaBpgKxoi2Q6GbeZLzu2MN7lvoLe25CrefOQe2PedPF28bVz+DxwowyxfaYxtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"블루투스 페어링 찾기\"\n        title=\"블루투스 페어링 찾기\"\n        src=\"/static/194dfd7cadd145c263b81627d171a238/fcda8/bluetooth-find.png\"\n        srcset=\"/static/194dfd7cadd145c263b81627d171a238/12f09/bluetooth-find.png 148w,\n/static/194dfd7cadd145c263b81627d171a238/e4a3f/bluetooth-find.png 295w,\n/static/194dfd7cadd145c263b81627d171a238/fcda8/bluetooth-find.png 590w,\n/static/194dfd7cadd145c263b81627d171a238/efc66/bluetooth-find.png 885w,\n/static/194dfd7cadd145c263b81627d171a238/84cc5/bluetooth-find.png 898w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>버튼을 클릭할 경우 주소창 쪽에 위와 같이 페어링할 장치를 찾는 팝업이 뜨게 됩니다.</p>\n<h2 id=\"본격적으로-통신하기\" style=\"position:relative;\"><a href=\"#%EB%B3%B8%EA%B2%A9%EC%A0%81%EC%9C%BC%EB%A1%9C-%ED%86%B5%EC%8B%A0%ED%95%98%EA%B8%B0\" aria-label=\"본격적으로 통신하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>본격적으로 통신하기</h2>\n<p>이제 페어링할 장치를 찾았습니다. 본격적으로 통신에 들어가 봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">windowNavigator<span class=\"token punctuation\">.</span>bluetooth<span class=\"token punctuation\">.</span><span class=\"token function\">requestDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  filters<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> services<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"4번 결과 값\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">device</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">getDevice</span><span class=\"token punctuation\">(</span>device<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> device<span class=\"token punctuation\">.</span>gatt<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">server</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">getPrimaryService</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4번 결과 값\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">service</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> service<span class=\"token punctuation\">.</span><span class=\"token function\">getCharacteristic</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"5번 결과 값\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">characteristic</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">getCharacteristic</span><span class=\"token punctuation\">(</span>characteristic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Connection failed!'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>GATT서버에 연결을 하고 service와 characteristic값을 얻습니다. 이로써 웹에서 통신할 기본 설정은 끝이고 이제 데이터를 읽고 쓸 차례입니다.</p>\n<h3 id=\"페어링-해제\" style=\"position:relative;\"><a href=\"#%ED%8E%98%EC%96%B4%EB%A7%81-%ED%95%B4%EC%A0%9C\" aria-label=\"페어링 해제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>페어링 해제</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getDevice</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">device</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  device<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gattserverdisconnected'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"디바이스 연결이 끊어졌습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>디바이스 정보를 얻게 되면 ‘gattserverdisconnected’ 이벤트로 페어링 해제를 감지 할 수 있습니다.</p>\n<h3 id=\"데이터-전송\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%86%A1\" aria-label=\"데이터 전송 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 전송</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getCharacteristic</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">characteristic</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  characteristic<span class=\"token punctuation\">.</span><span class=\"token function\">writeValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Unit8Array에 데이터를 담아 통신이 가능합니다. 20byte 제한이 걸려 있습니다. 위 코드는 순서대로 4, 3, 2, 1 데이터를 라인마다 송신합니다. 송신한 값은 아두이노에서 Serial.read 함수를 사용해 하나씩 받아 올 수 있습니다.</p>\n<h3 id=\"데이터-받기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9B%EA%B8%B0\" aria-label=\"데이터 받기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 받기</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getCharacteristic</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">characteristic</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  characteristic<span class=\"token punctuation\">.</span><span class=\"token function\">startNotifications</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    characteristic<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'characteristicvaluechanged'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">getUint8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>데이터 또한 Uint8 형식으로 넘어와 다음과 같이 값을 읽을 수 있습니다.</p>\n<h2 id=\"블루투스-통신-결과물\" style=\"position:relative;\"><a href=\"#%EB%B8%94%EB%A3%A8%ED%88%AC%EC%8A%A4-%ED%86%B5%EC%8B%A0-%EA%B2%B0%EA%B3%BC%EB%AC%BC\" aria-label=\"블루투스 통신 결과물 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>블루투스 통신 결과물</h2>\n<p><img src=\"/97c00eec012748bedc6b3d55639f82b8/bluetooth-test.gif\" alt=\"블루투스 통신\"></p>\n<p>제가 웹과의 블루투스 통신을 통하여 제작한 로봇입니다. 웹을 사용하여 로봇을 조종하는 모습을 확인 할 수 있습니다. </p>\n<p><a href=\"https://github.com/dawan0111/coding-robot\">git 소스코드</a></p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<p><a href=\"https://googlechrome.github.io/samples/web-bluetooth/\">web bluetooth api examples</a></p>","frontmatter":{"title":"Web과 Arduino를 Bluetooth로 통신하기","date":"December 27, 2020","thumbnail":null}}},"pageContext":{"slug":"/javascript/web-bluetooth-통신/","previous":{"fields":{"slug":"/javascript/웹 워커(Web worker)로 DOM 업데이트 개선/"},"frontmatter":{"title":"웹 워커(Web worker)로 DOM 업데이트 개선","category":"javascript"}},"next":{"fields":{"slug":"/etc/2020년-회고록/"},"frontmatter":{"title":"2020년 회고록","category":"etc"}}}},"staticQueryHashes":["3128451518","96099027"]}